# История изменений:

#### v5.0.0:
#### закрыта critical уязвимость сервиса, фронт с react-router
* fix: закрыт доступ к бд снаружи докера
* fix: исправлены несколько багов на фронте и в логике работы с дампами
* fix: исправлен тестовый db-репозиторий с моком IQueryable
* upd: обновлены версии зависимостей
* upd: изменена структура проекта 
  - добавлены скрипты для npm
  - проект фронта убран из решения, редуцирован до файлов и разложен по виртуальным папкам (временный вариант)
* upd: начата чистка кода и изменение именований, в т.ч. контекста EF
* upd: добавлено использование SQLite для запуска интеграционных тестов и пример интеграционника
* ci: добавлен пробный пайплайн для прогона билда и тестов под .NET

#### v5.1.0
#### настройка локальной и удаленной разработки: подготовка CI/CD
* fix: фронт переработан для разработки с Vite 10.2.4 под Node 21.5.0 - npm 10.2.4 - React 17.0.0
  - время билда, количество зависимостей и артефактов сократилось на порядок
  - сборка проверена на младших версиях Node (18.19.0, 20.10.0)
* fix: поправлено использование кук совместно с CORS - модифицируется SameSite для соответсвия [**draft-west-cookie-incrementalism-00**](https://datatracker.ietf.org/doc/html/draft-west-cookie-incrementalism-00)
* upd: добавлен докерфайл для билда образа .NET + React
* upd: добавлен лаунчер среды разработки для JS (управление dev-сервером и браузером)
* ci: добавлен пробный пайплайн для прогона билда под Node.JS
* ci: добавлен пробный пайплайн для прогона билда образа сервиса с фронтом
* ci: добавлен пробный пайплайн для публикации докер-образа в GitHub Registry
* ci: тк на CI внутри билда .NET стал запускаться npm build, пререлизный JavaScript.Sdk был заменен на NET.Sdk и esproj исрправлен на csproj
* ci: для .NET использован базовый образ alpine, размер итогового образа сокращен в два раза
* cd: добавлен пробный пайплайн деплоя на удалённый сервер
* cd: добавлен пробный пайплайн для развертывания в кластере kubernetes k3s и манифесты для сервиса и mysql (в процессе проверки)

#### v5.1.1
#### настройка SSL
* fix: отключена модификация cookie для prod
* upd: https ready: изменен манифест ingress для поддержи DV SSL сертификата  
  kubectl create secret tls secret-tls --key=... --cert=...

#### v5.1.2
#### публикация API и переименование полей бд
* upd: переименованы файлы GitHub CI/CD
* upd: переименованы файлы манифестов K3S
* upd: проекты очищены от лишних комментариев
* upd: добавлены summary
* upd: исправлена структура проекта
* upd: отредактировано и опубликовано API
* upd: переименованы поля бд и дампа

#### v5.2.0
#### подъём версий
* upd: .NET8 + dockerfile
* upd: React 18 + Router 6
* upd: добавлен тестовый фреймворк для React: Vitest 1.2.2
* upd: запуск JS тестов на CI
* fix: подняты версии раннеров и SQLite (баг)
* fix: разделена конфигурация Vite для тестов и разработки

#### v5.2.x
#### клиент: правки по техдолгу
* 5.2.1 upd: конкретизированы типы TS
* 5.2.1 upd: компоненты клиента переписаны на функциональные
* 5.2.2 upd: переработанный глобальный стейт поставляется через контекст
* 5.2.2 upd: внешний стейт упрощен и разделен на recovery и common, компоненты разделены по файлам
* 5.2.3 upd: убраны стейт-машины из комопнентов Catalog и Read
* 5.2.4 business: мёрж дампа + расширение textbox
* 5.2.5 business: дополнен функционал сохранности данных + security-апдейт js + тесты vitest
* 5.2.6
  * business: добавлена политика авторизации, увеличен размер текста в заметке
  * observability: добавлены метрики и рейтлимитер на техническую ручку server_url/metrics
  * observability: добавлен Serilog
  * observability: добавлена трассировка в консоль для Debug
  * fix: исправлены угрозы безопасности (npm-пакеты), исправлен функционал запуска dev-сервера
* 5.2.7 front: модальное диалоговое окно 
* 5.2.x upd: настройка доступа по ssl-сертификату для нового домена notefinder.ru
   * k3s: добавлены и протестированы k3s-конфиги traefik для доступа по ip и https-доступа с адреса notefinder.ru
   * ssl: crt-бандл использован без root-сертификата: notefinder.noroot.crt
* 5.2.9
  * css: адаптивная grid-вёрстка для двух размеров экрана
  * upd: контроллер update целиком убран под авторизацию
  * upd: при перезагрузке страницы авторизация проверяется на сервере и кэшируется в local storage
  * dbs: переход на postgres: см [DEVLOG.md](src/Rsse.Data/DEVLOG.md)
  * test: интеграционные тесты в контейнерах локально и на пайплайне  
  * upd: добавлены ручки аплоада файла дампа и замены данных авторизации  
  * k3s: добавлен манифест на postgres  

# Запланированные изменения:
* **БД**: ✅ перейти с MySQL на Postgres, функционал дампа дополнить раздельными миграциями схемы и данных
	  добавить k3s ресурсы для Postgres
* **Тесты**: юниты для JS, подготовить среду для E2E тестов, покрыть код автотестами, ✅ интеграционные (бд в контейнерах) на ci/cd
* **React**: ✅ упростить контейнер со стейтом, ~~подумать над применимостью в клиенте Flux/Redux~~
* **GitHub CI**: соединить пробные пайплайны в один, завязать публикацию образа на выпуск релиза
                 и использовать для него артефакты билда сервиса и фронта
* **GitHub CD**: подготовить варианты интеграции с высокодоступным кластером: сейчас сервис задеплоен на k3s
* **Permanent**: обеспечить дополнительную сохранность данных при необратимых действиях пользователя
* **UI**:
  * ✅ разделить верстку для мобильных устройств и десктопа, добавить modal-окна
    * вынести общие для всех устройств стили в отдельный файл CSS
    * ✅ добавить специфичные для устройств стили в отдельный файл CSS
  * вынести системный функционал в отдельную админку, переписать компонент с авторизацией
  * добавить понятный пользователю вывод ошибок
  * - [x] на стороне клиента: увеличить длину списка похожих до 20
  * базовый функционал - нечеткий поиск, отображение тегов - находится под авторизацией,  
    для демонстрации возможностей (а не только факта деплоя) следует создать компонент поиска/отображения тегов
* **Планы обновлений**: 
  * поднять версии до NET9 | pg 17.4 | react 19 - поправить пайплайны и докерфайлы для новых версий
  * актуализировать версии в package.json | system/version, зафиксировать в документации, создать релиз
